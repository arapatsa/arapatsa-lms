<%page expression_filter="h"/>
<%inherit file="/main.html" />
<%namespace name='static' file='/static_content.html'/>
<%!
from django.utils.translation import ugettext as _

from openedx.core.djangolib.markup import HTML
from openedx.core.djangolib.js_utils import js_escaped_string

%>
<%def name="course_name()">
 <% return _("{course_number} Courseware").format(course_number=course.display_number_with_default) %>
</%def>
<%block name="bodyclass">view-in-course view-courseware courseware ${course.css_class or ''}</%block>
<%block name="title"><title>
    % if section_title:
${static.get_page_title_breadcrumbs(section_title, course_name())}
    % else:
${static.get_page_title_breadcrumbs(course_name())}
    %endif
</title></%block>

<%block name="header_extras">
% for template_name in ["image-modal"]:
<script type="text/template" id="${template_name}-tpl">
    <%static:include path="common/templates/${template_name}.underscore" />
</script>
% endfor
<%
  header_file = None
%>
</%block>

<%block name="headextra">
<%static:css group='style-course-vendor'/>
<%static:css group='style-course'/>

<script type="text/javascript" src="${static.url('js/jquery.autocomplete.js')}" async></script>
<script type="text/javascript" src="${static.url('js/src/tooltip_manager.js')}" async></script>

<link href="${static.url('css/vendor/jquery.autocomplete.css')}" rel="preload" type="text/css">
  ${HTML(fragment.head_html())}

% if is_learning_mfe:
  ## If this chromeless view is in an iframe in the learning microfrontend app
  ## then add a base tag in the head (of the iframe document) to force links
  ## in this iframe to navigate the parent window.
  <base target="_parent">
%endif

## Expose the $$course_id variable for course-team-authored JS.
## We assign it in the <head> so that it will definitely be
## assigned before any in-XBlock JS is run.
<script type="text/javascript">
  var $$course_id = "${course.id | n, js_escaped_string}";
</script>

</%block>

<%block name="js_extra">
  <script type="text/javascript" src="${static.url('common/js/vendor/jquery.scrollTo.js')}" async></script>
  <script type="text/javascript" src="${static.url('js/vendor/flot/jquery.flot.js')}" async></script>

  <%static:js group='courseware'/>

  % if enable_mathjax:
    <%include file="/mathjax_include.html" args="disable_fast_preview=True"/>
  % endif
  % if staff_access:
  	<%include file="xqa_interface.html"/>
  % endif

${HTML(fragment.foot_html())}

</%block>
<div class="course-wrapper chromeless">
  <section class="course-content" id="course-content"\
    % if enable_completion_on_view_service:
      data-enable-completion-on-view-service="true" \
    % else:
      data-enable-completion-on-view-service="false" \
    % endif
    style="display: block; width: auto; margin: 0;"
  >
      <main id="main" aria-label="Content">
        ${HTML(fragment.body_html())}
      </main>
  </section>
</div>
% if block.category == "drag-and-drop-v2":
  <script type="text/javascript">
    $(document).ready(function() {
        $('meta[name=viewport]').attr('content', 'width=device-width, initial-scale=0.3');
    });
  </script>
% endif
<script type="text/javascript">
  $(document).ready(function(){
    $(".course-wrapper.chromeless a").on("click", function(e){
      e.preventDefault();
      var external_link = $(this).attr("href")
      if (window.JsInterface) {
          JsInterface.openExternalLink(external_link)
      } else {
          window.location.href = external_link;
      }
    });
  });
</script>